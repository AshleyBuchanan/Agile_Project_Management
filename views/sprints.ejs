<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agile Project Manager</title>
    <link rel="icon" href="/icons/agileImage.png" type="image/x-icon">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/nav.css">
    <link rel="stylesheet" href="/css/dashboards.css">
    <link rel="stylesheet" href="/css/panels.css">
    <link rel="stylesheet" href="/css/cards.css">
</head>

<body>
    <%- include('partials/nav.ejs') %>

    <div class="main-flex">
        <section class="dashboard">
            <header>
                <img width="55px" src="/icons/fm_be_web.png" alt="">
                <%- users[0].team %>
            </header>
            <div class="selector-block">
                <div class="selector">
                    <img class="icon" src="/icons/files_icon.png" alt=""> Backlog
                </div>
                <div class="selector active">
                    <img class="icon" src="/icons/forward_icon.png" alt=""> Active sprints
                </div> 
                <div class="selector">
                    <img class="icon" src="/icons/report_icon.png" alt=""> Reports
                </div>
            </div>
            <div class="collapse"><span class="icon">&laquo;</span></div>
        </section>
        <div class="main-container">
            <div class="top-level-1">
                <div class="left">Active Sprints</div>
                <span class="right"></span>

                <div>
                    <div class="middle">&#128337; 10 days remaining <span class="bubble-long inactive">Complete sprint</span></div>
                   
                </div>
                <div class="right-margin">
                    <span class="bubble-long">Links Hierarchy</span>
                    <span class="bubble-long">Board</span> 
                    <span class="bubble-long">&circlearrowleft;</span> 
                </div>
 
            </div>
            <div class="top-level-2">
                <span class="quick-filter">QUICK FILTERS:</span>
                <% for (let i=0; i<shortcuts.length; i++){ %>
                    <div class="bubble-long"><%- shortcuts[i] %></div>
                <% } %>
            </div>
            <div class="top-level-3">
                <!-- Header row with panel titles -->
                <div class="panel-row">
                    <div class="panel-header">
                        <% for(let i=0; i<7; i++){ %>
                            <div class="panel-column">
                                <div class="panel-title"><%- panelNames[i] %></div>
                            </div>
                        <% } %>
                    </div>
                </div>
            </div>
            <div class="panel-block">      
                <!-- Each project gets its own row of 7 panels -->
                <% for (let j=0; j<allSprints.length; j++){ %>
                    <div class="panel-row">
                        <div class="project-title-row"><%- allSprints[j] %></div>
                    </div>
                    <div class="panel-row">
                        <% for (let i=0; i<7; i++){ %>
                            <div class="panel-column">
                                <% if (panelNames[i] === 'START') { %>
                                    <div class="panel" data-project="<%- allSprints[j] %>" data-step="START" data-allowedfrom="['']"></div>
                                <% } %>
                                <% if (panelNames[i] === 'BLOCKED') { %>
                                    <div class="panel" data-project="<%- allSprints[j] %>" data-step="BLOCKED" data-allowedfrom="['IN PROGRESS','CODE REVIEW','TESTING','QE VALIDATION']"></div>
                                <% } %>
                                <% if (panelNames[i] === 'IN PROGRESS') { %>
                                    <div class="panel" data-project="<%- allSprints[j] %>" data-step="IN PROGRESS" data-allowedfrom="['START','BLOCKED', 'CODE REVIEW', 'TESTING','QE VALIDATION']"></div>
                                <% } %>
                                <% if (panelNames[i] === 'CODE REVIEW') { %>
                                    <div class="panel" data-project="<%- allSprints[j] %>" data-step="CODE REVIEW" data-allowedfrom="['IN PROGRESS','TESTING','QE VALIDATION']"></div>
                                <% } %>
                                <% if (panelNames[i] === 'TESTING') { %>
                                    <div class="panel" data-project="<%- allSprints[j] %>" data-step="TESTING" data-allowedfrom="['IN PROGRESS','CODE REVIEW','QE VALIDATION']"></div>
                                <% } %>
                                <% if (panelNames[i] === 'QE VALIDATION') { %>
                                    <div class="panel" data-project="<%- allSprints[j] %>" data-step="QE VALIDATION" data-allowedfrom="['CODE REVIEW','TESTING']"></div>
                                <% } %>
                                <% if (panelNames[i] === 'DONE') { %>
                                    <div class="panel" data-project="<%- allSprints[j] %>" data-step="DONE" data-allowedfrom="['QE VALIDATION']"></div>
                                <% } %>
                            </div>
                        <% } %>
                    </div>
                <% } %>
            </div>
        </div>
    </div>
 
    <script src="/js/sprints.js"></script>
</body>

</html>